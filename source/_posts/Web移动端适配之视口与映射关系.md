---
title: Web移动端适配之视口与映射关系
date: 2017-04-17 09:45:11
catagory: tech
tags: [前端, 移动端, 响应式]
---

上一篇讨论移动端适配的时候列出了一些结论，在这里回顾一下其中最重要的几个也就是今天要讨论的几项内容：
1. 在PC端用户未缩放的情况下，html默认宽度恒等于浏览器宽度
2. 缩放本质上讲就是一种原始像素=>设备像素的映射关系。
3. 在移动端下，html宽度不一定等于浏览器宽度，默认情况下会对html进行“初始缩放”
4. 移动端用户缩放时不会改变html的宽度，只会修改原像素=>实际像素的映射关系。
5. 在不进行缩放的情况下，影响最终用户见到的尺寸的因素：设备长度，CSS定义的像素数，经过初始缩放后的html像素数

不过在我们谈“初始缩放”之前，我们先理清一下涉及到Web中的所有映射关系。

# 映射关系
要遍历清所有的映射关系，我们就得想一遍界面从编写到显示中涉及到位置的所有过程。当然我们这篇文章还是只讨论横向方向。
> 记映射关系 a => b = 1 : x 代表a上每1个像素在b上显示为x个像素

## PC端
1. 程序员为html中的各元素编写CSS(绝对的或相对的)
2. 浏览器加载html，设置html.width为browser.width，设置映射关系html=>browser = 1:1，并计算html下的所有元素的位置
3. 当浏览器大小改变时，重新设置html.width为browser.width，并计算html下的所有元素的位置
4. 当用户进行缩放时，重新设置html.width为browser.width / scaleRatio，设置映射关系html=>browser=1:scaleRatio，并计算html下的所有元素的位置

涉及到的映射关系：
1. 未缩放时html => browser = 1 : 1
2. 缩放时html => browser = 1 : scaleRatio

## 移动端
1. 程序员为html中的各元素编写CSS(绝对的或相对的)
2. 浏览器加载html，设置html.width为browser.width / “初始缩放”，并计算html下的所有元素的位置
3. 当用户进行缩放时，
